<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <base href="https://edypizzariadelivery.github.io/" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Edy Pizzaria - O melhor delivery de pizzas. Confira nosso cardÃ¡pio e faÃ§a seu pedido pelo WhatsApp!">
    <meta name="keywords" content="Pizzaria, Delivery, Pizza, Edy Pizzaria">
    <title>ðŸ¤– | Atendimento Elair</title>
    <link rel="icon" href="https://edypizzariadelivery.github.io/logo.jpg" type="image/png">
    
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
        <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap');
body, html {
    margin: 0;
    padding: 0;
    height: 100%;
    font-family: 'Roboto', Arial, sans-serif;
}

.frame-container {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #002D24;
}

.frame-4-3 {
    position: relative;
    background: #ffffff;
    box-sizing: border-box;
    border: 2px solid #1c4c7d;
    display: flex;
    flex-direction: column;
}

.content-wrapper {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.container {
    display: grid;
    grid-template-areas: 
        "logo gif-area"
        "chat-area cart"
        "chat-area bot-gif";
    grid-template-columns: 3fr 1fr;
    grid-template-rows: auto 1fr auto;
    gap: 10px;
    padding: 10px;
    box-sizing: border-box;
    background-color: rgba(0,0,0,0.5);
    border-radius: 10px;
    height: 100%;
}

.logo {
    grid-area: logo;
    display: flex;
    justify-content: center;
    align-items: center;
}

.logo img {
    max-width: 100px;
    height: auto;
}

.gif-area {
    grid-area: gif-area;
    background-color: #F5E050;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    overflow: hidden;
}

#currentGif {
    width: 100%;
    height: auto;
    object-fit: cover;
}

.chat-area {
    grid-area: chat-area;
    background-color: #B80000;
    padding: 10px;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
}

.chat-box {
    background: #FFFFFF;
    color: #000000;
    flex-grow: 1;
    margin-bottom: 10px;
    overflow-y: auto;
    padding: 10px;
    border-radius: 5px;
}

.message {
    margin-bottom: 10px;
    padding: 8px 12px;
    border-radius: 5px;
    max-width: 80%;
}

.bot-message {
    background-color: #f1f1f1;
    align-self: flex-start;
}

.user-message {
    background-color: #e1f5fe;
    align-self: flex-end;
}

.chat-input {
    display: flex;
    gap: 10px;
}

.chat-input input {
    flex-grow: 1;
    padding: 10px;
    border: none;
    border-radius: 4px;
}

.btn {
    padding: 10px 20px;
    background-color: #00FF00;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.3s;
}

.btn:hover {
    background-color: #00CC00;
}

.cart {
    grid-area: cart;
    background-color: #FFFFFF;
    color: #000000;
    padding: 10px;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
}

#cartItems {
    list-style-type: none;
    padding: 0;
    margin: 10px 0;
    flex-grow: 1;
    overflow-y: auto;
}

#cartItems li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    border-bottom: 1px solid #ccc;
    padding-bottom: 5px;
}

.cart-item-controls {
    display: flex;
    align-items: center;
}

.cart-item-controls button {
    background-color: #4CAF50;
    color: white;
    border: none;
    padding: 5px 10px;
    margin: 0 5px;
    cursor: pointer;
    border-radius: 3px;
}

.bot-gif {
    grid-area: bot-gif;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    border-radius: 8px;
}

#botGif {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.bot-message img {
    width: 1em;
    height: auto;
    vertical-align: middle;
}

.options-buttons {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 10px;
    margin-top: 10px;
}

.option-btn {
    background-color: #4CAF50;
    border: none;
    color: white;
    padding: 10px 15px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 14px;
    margin: 2px;
    cursor: pointer;
    border-radius: 4px;
}

.pizza-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.pizza-option img {
    width: 100px;
    height: 100px;
    object-fit: cover;
    border-radius: 50%;
    margin-bottom: 5px;
}

.icons-box {
    position: absolute;
    left: 10px;
    top: 10px;
    background: #2e6ea6;
    padding: 10px;
    border-radius: 10px;
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 10px;
    border: 2px solid #ffffff;
}

.icon {
    width: 40px;
    height: 40px;
    background: #ffffff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    cursor: pointer;
    text-decoration: none;
    font-size: 20px;
    line-height: 1;
    transition: transform 0.2s ease;
}

@media (max-width: 768px) {
    .container {
        grid-template-areas: 
            "logo logo"
            "chat-area chat-area"
            "cart cart"
            "gif-area bot-gif";
        grid-template-columns: 1fr 1fr;
    }

    .icons-box {
        top: 5px;
        left: 5px;
        padding: 5px;
    }

    .icon {
        width: 30px;
        height: 30px;
        font-size: 16px;
    }
}

@media (max-width: 480px) {
    .container {
        grid-template-areas: 
            "logo"
            "chat-area"
            "cart"
            "gif-area"
            "bot-gif";
        grid-template-columns: 1fr;
    }

    .icons-box {
        top: 2px;
        left: 2px;
        padding: 3px;
    }

    .icon {
        width: 25px;
        height: 25px;
        font-size: 14px;
    }
}

.overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
}

#startButton {
    padding: 20px 40px;
    font-size: 24px;
    cursor: pointer;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 10px;
    transition: all 0.3s ease;
    animation: pulse 1.5s infinite;
}

#startButton:hover {
    background-color: #45a049;
    transform: scale(1.05);
}

@keyframes pulse {
    0% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.05);
    }
    100% {
        transform: scale(1);
    }
}
</style>
</head>
<body>
<div class="frame-container">
    <div class="frame-4-3">
        <div class="content-wrapper">
            <div class="container">
                <header class="logo">
                    <img src="https://edypizzariadelivery.github.io/logo.jpg" alt="Logo Edy Pizzaria">
                </header>
                
                <div class="gif-area">
                    <img src="https://edypizzariadelivery.github.io/entrega.gif" alt="GIF Alternativo" id="currentGif">
                </div>
                
                <div class="chat-area">
                    <div class="chat-box" id="chatBox"></div>
                    <div class="chat-input">
                        <input type="text" id="chatInput" placeholder="Digite sua mensagem...">
                        <button id="sendChat" class="btn">ENVIAR</button>
                    </div>
                    <div class="options-buttons" id="optionsButtons"></div>
                </div>
                
                <aside class="cart">
                    <h2>CARRINHO ðŸ›’</h2>
                    <ul id="cartItems"></ul>
                    <p>Total: R$ <span id="totalPrice">0,00</span></p>
                    <button id="sendOrder" class="btn">ENVIAR PEDIDO</button>
                </aside>
                
                <div class="bot-gif">
                    <img src="https://edypizzariadelivery.github.io/rino.gif" alt="Bot GIF" id="botGif">
                </div>
            </div>
        </div>
        <div class="icons-box">
            <a href="https://websim.io/game" class="icon" title="Ir para Game">
                ðŸŽ®
            </a>
            <a href="https://websim.io/robo" class="icon" title="Ir para RobÃ´">
                ðŸ¤–
            </a>
        </div>
    </div>
</div>

<script>
function adjustFrame() {
    const container = document.querySelector('.frame-container');
    const frame = document.querySelector('.frame-4-3');
    const aspectRatio = 4 / 3;
    
    let frameWidth, frameHeight;
    
    if (container.clientWidth / container.clientHeight > aspectRatio) {
        frameHeight = container.clientHeight * 0.98;
        frameWidth = frameHeight * aspectRatio;
    } else {
        frameWidth = container.clientWidth * 0.98;
        frameHeight = frameWidth / aspectRatio;
    }
    
    frame.style.width = `${frameWidth}px`;
    frame.style.height = `${frameHeight}px`;
}

window.addEventListener('load', adjustFrame);
window.addEventListener('resize', adjustFrame);

let startTime;

window.onload = function() {
    startTime = new Date().getTime();
    addStartButton();
}

function addStartButton() {
    const existingOverlay = document.querySelector('.overlay');
    if (!existingOverlay) {
        const overlay = document.createElement('div');
        overlay.className = 'overlay';
        
        const startButton = document.createElement('button');
        startButton.id = 'startButton';
        startButton.innerText = 'Iniciar Atendimento';
        startButton.onclick = startInteraction;
        
        overlay.appendChild(startButton);
        document.body.appendChild(overlay);
    }
}

function startInteraction() {
    const overlay = document.querySelector('.overlay');
    if (overlay) {
        overlay.remove();
    }

    let welcomeAudio = new Audio('https://edypizzariadelivery.github.io/bv.mp3');
    welcomeAudio.play();

    addBotMessage("Bem-vindo Ã  Edy Pizzaria! Qual Ã© o seu nome?", "Bem-vindo");
}

const chatBox = document.getElementById('chatBox');
const chatInput = document.getElementById('chatInput');
const sendChatBtn = document.getElementById('sendChat');
const sendOrderBtn = document.getElementById('sendOrder');
const cartItemsContainer = document.getElementById('cartItems');
const totalPriceElement = document.getElementById('totalPrice');
const gifDisplay = document.getElementById('currentGif');
const optionsButtons = document.getElementById('optionsButtons');

const botGifs = {
    "Bem-vindo": "https://edypizzariadelivery.github.io/rino.gif",
    "OlÃ¡": "https://edypizzariadelivery.github.io/entrega.gif",
    "Desculpe_pizza": "https://edypizzariadelivery.github.io/gif3.gif",
    "Escolha_segundo_sabor": "https://edypizzariadelivery.github.io/gif4.gif",
    "Escolha_tamanho": "https://edypizzariadelivery.github.io/gif5.gif",
    "Escolha_M_G": "https://edypizzariadelivery.github.io/gif6.gif",
    "Deseja_borda": "https://edypizzariadelivery.github.io/gif7.gif",
    "Pizza_adicionada": "https://edypizzariadelivery.github.io/gif8.gif",
    "Como_receber": "https://edypizzariadelivery.github.io/gif9.gif",
    "Entrega_selecionada": "https://edypizzariadelivery.github.io/gif10.gif",
    "Informe_bairro": "https://edypizzariadelivery.github.io/gif11.gif",
    "Informe_rua": "https://edypizzariadelivery.github.io/gif12.gif",
    "Informe_numero": "https://edypizzariadelivery.github.io/gif13.gif",
    "Pedido_confirmado": "https://edypizzariadelivery.github.io/gif14.gif",
    "Total_preco": "https://edypizzariadelivery.github.io/gif15.gif",
    "Enviar_whatsapp": "https://edypizzariadelivery.github.io/gif16.gif",
    "Desculpe_repetir": "https://edypizzariadelivery.github.io/gif17.gif"
};

const botAudios = {
    "Bem-vindo": "https://edypizzariadelivery.github.io/bv.mp3",
    "OlÃ¡": "https://edypizzariadelivery.github.io/escolha.mp3",
    "Desculpe_pizza": "https://edypizzariadelivery.github.io/audio3.mp3",
    "Escolha_segundo_sabor": "audio4.mp3",
    "Escolha_tamanho": "audio5.mp3",
    "Escolha_M_G": "https://edypizzariadelivery.github.io/Escolha_M_G.mp3",
    "Deseja_borda": "audio7.mp3",
    "Pizza_adicionada": "audio8.mp3",
    "Como_receber": "audio9.mp3",
    "Entrega_selecionada": "audio10.mp3",
    "Informe_bairro": "audio11.mp3",
    "Informe_rua": "audio12.mp3",
    "Informe_numero": "audio13.mp3",
    "Pedido_confirmado": "audio14.mp3",
    "Total_preco": "audio15.mp3",
    "Enviar_whatsapp": "audio16.mp3",
    "Desculpe_repetir": "audio17.mp3"
};

const pizzas = [
    { name: 'Frango com Catupiry', description: 'IrresistÃ­vel mistura de frango desfiado com o cremoso catupiry.', price: 34.99, image: 'https://edypizzariadelivery.github.io/frango.webp' },
    { name: 'Carne Seca', description: 'Saborosa combinaÃ§Ã£o de carne seca desfiada, cebola e catupiry.', price: 39.99, image: 'https://edypizzariadelivery.github.io/carne-seca.webp' },
    { name: 'Calabresa', description: 'Deliciosa pizza coberta com fatias de calabresa, cebola e azeitonas.', price: 34.99, image: 'https://edypizzariadelivery.github.io/calabresa.webp' },
    { name: 'Lombo canadense', description: 'IrresistÃ­vel combinaÃ§Ã£o de Lombo canadense, mussarela, cebola, requeijÃ£o cremoso.', price: 39.99, image: 'https://edypizzariadelivery.github.io/lombo.jpg' }
];

let state = {
    userName: '',
    selectedPizzas: [],
    size: 'M',
    stuffedBorder: false,
    paymentMethod: '',
    deliveryMethod: '',
    address: {},
    totalPrice: 0,
    currentStep: 'name'
};

const cart = [];

function addToCart(pizza) {
    const existingItem = cart.find(item => item.name === pizza.name && item.size === state.size);
    if (existingItem) {
        existingItem.quantity++;
    } else {
        cart.push({
            ...pizza,
            quantity: 1,
            size: state.size,
            stuffedBorder: state.stuffedBorder
        });
    }
    updateCart();
    updateTotalPrice();
    updateGif();
}

function updateCart() {
    cartItemsContainer.innerHTML = '';
    cart.forEach((item, index) => {
        const li = document.createElement('li');
        li.innerHTML = `
            <div>
                <strong>${item.name}</strong>
                <p>${item.size} ${item.stuffedBorder ? '(Borda Recheada)' : ''}</p>
                <p>R$ ${(item.price * item.quantity).toFixed(2)}</p>
            </div>
            <div class="cart-item-controls">
                <button onclick="decreaseQuantity(${index})">-</button>
                <span>${item.quantity}</span>
                <button onclick="increaseQuantity(${index})">+</button>
                <button onclick="removeFromCart(${index})">Remover</button>
            </div>
        `;
        cartItemsContainer.appendChild(li);
    });
}

function removeFromCart(index) {
    cart.splice(index, 1);
    updateCart();
    updateTotalPrice();
    updateGif();
}

function updateTotalPrice() {
    state.totalPrice = cart.reduce((total, item) => {
        let itemPrice = item.price;
        if (item.size === 'G') itemPrice += 5;
        if (item.stuffedBorder) itemPrice += 3;
        return total + (itemPrice * item.quantity);
    }, 0);

    if (state.deliveryMethod === 'delivery') {
        state.totalPrice += 3;
    }

    totalPriceElement.textContent = state.totalPrice.toFixed(2);
}

function updateGif() {
    const gifs = [
        'https://edypizzariadelivery.github.io/rino.gif',
        'https://edypizzariadelivery.github.io/gif2.gif',
        'https://edypizzariadelivery.github.io/gif3.gif'
    ];
    gifDisplay.src = cart.length > 0 ? gifs[0] : gifs[2];
}

sendOrderBtn.addEventListener('click', function() {
    if (cart.length === 0) {
        addBotMessage("Desculpe, nÃ£o temos essa pizza. Por favor, escolha uma das opÃ§Ãµes disponÃ­veis.", "Desculpe_pizza");
        return;
    }
    addBotMessage("Como vocÃª prefere receber seu pedido?", "Como_receber");
    showOptions(['Entrega', 'Retirar no local']);
    state.currentStep = 'delivery_method';
});

sendChatBtn.addEventListener('click', sendMessage);
chatInput.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') sendMessage();
});

function sendMessage() {
    const message = chatInput.value.trim();
    if (message) {
        addMessage(message, 'user-message');
        chatInput.value = '';
        processMessage(message);
    }
}

function addMessage(message, type) {
    const messageElement = document.createElement('div');
    messageElement.className = `message ${type}`;
    messageElement.innerHTML = message;
    chatBox.appendChild(messageElement);
    chatBox.scrollTop = chatBox.scrollHeight;
}

function addBotMessage(message, gifKey) {
    const gifUrl = botGifs[gifKey] || '';
    const messageWithGif = gifUrl ? `<img src="${gifUrl}" alt="GIF" class="bot-gif"> ${message}` : message;
    addMessage(messageWithGif, 'bot-message');
    
    const audioFile = botAudios[gifKey];
    if (audioFile) {
        const audio = new Audio(audioFile);
        audio.play().catch(error => console.log('Audio playback failed:', error));
    }
}

function processMessage(message) {
    switch(state.currentStep) {
        case 'name':
            state.userName = message;
            addBotMessage(`OlÃ¡ ${state.userName}! Qual pizza vocÃª gostaria de pedir?`, "OlÃ¡");
            showPizzaOptions();
            state.currentStep = 'pizza_selection';
            break;
        case 'pizza_selection':
            const selectedPizza = pizzas.find(p => p.name.toLowerCase() === message.toLowerCase());
            if (selectedPizza) {
                state.selectedPizzas = [selectedPizza];
                showSizeOptions();
            } else {
                addBotMessage("Desculpe, nÃ£o temos essa pizza. Por favor, escolha uma das opÃ§Ãµes disponÃ­veis.", "Desculpe_pizza");
                showPizzaOptions();
            }
            break;
        case 'mixed_pizza_1':
            const firstPizza = pizzas.find(p => p.name.toLowerCase() === message.toLowerCase());
            if (firstPizza) {
                state.selectedPizzas = [firstPizza];
                addBotMessage('Escolha o segundo sabor:', "Escolha_segundo_sabor");
                showPizzaOptions();
                state.currentStep = 'mixed_pizza_2';
            } else {
                addBotMessage("Desculpe, nÃ£o temos essa pizza. Por favor, escolha uma das opÃ§Ãµes disponÃ­veis.", "Desculpe_pizza");
                showPizzaOptions();
            }
            break;
        case 'mixed_pizza_2':
            const secondPizza = pizzas.find(p => p.name.toLowerCase() === message.toLowerCase());
            if (secondPizza) {
                state.selectedPizzas.push(secondPizza);
                showSizeOptions();
            } else {
                addBotMessage("Desculpe, nÃ£o temos essa pizza. Por favor, escolha uma das opÃ§Ãµes disponÃ­veis.", "Desculpe_pizza");
                showPizzaOptions();
            }
            break;
        case 'size_selection':
            if (['M', 'G', 'M - R$ 34,99', 'G - R$ 39,99'].includes(message.toUpperCase())) {
                state.size = message.toUpperCase().charAt(0);
                showBorderOptions();
            } else {
                addBotMessage("Por favor, escolha M para mÃ©dia ou G para grande.", "Escolha_M_G");
                showSizeOptions();
            }
            break;
        case 'border_selection':
            if (['Sim', 'NÃ£o'].includes(message)) {
                state.stuffedBorder = message === 'Sim';
                addPizzaToCart();
                addBotMessage("Pizza adicionada ao carrinho. Deseja mais alguma coisa?", "Pizza_adicionada");
                showOptions(['Sim, outra pizza', 'NÃ£o, finalizar pedido']);
                state.currentStep = 'additional_pizza';
            } else {
                addBotMessage("Por favor, escolha Sim ou NÃ£o para a borda recheada.", "Deseja_borda");
                showBorderOptions();
            }
            break;
        case 'additional_pizza':
            if (message === 'Sim, outra pizza') {
                showPizzaOptions();
                state.currentStep = 'pizza_selection';
            } else if (message === 'NÃ£o, finalizar pedido') {
                addBotMessage("Como vocÃª prefere receber seu pedido?", "Como_receber");
                showOptions(['Entrega', 'Retirar no local']);
                state.currentStep = 'delivery_method';
            } else {
                addBotMessage("Por favor, escolha uma das opÃ§Ãµes disponÃ­veis.", "Desculpe_repetir");
                showOptions(['Sim, outra pizza', 'NÃ£o, finalizar pedido']);
            }
            break;
        case 'delivery_method':
            if (message === 'Entrega') {
                state.deliveryMethod = 'delivery';
                addBotMessage("Entrega selecionada. SerÃ¡ cobrada uma taxa adicional de R$ 3,00.", "Entrega_selecionada");
                addBotMessage("Por favor, informe seu bairro:", "Informe_bairro");
                state.currentStep = 'bairro';
            } else if (message === 'Retirar no local') {
                state.deliveryMethod = 'pickup';
                finalizePedido();
            } else {
                addBotMessage("Por favor, escolha uma das opÃ§Ãµes disponÃ­veis.", "Desculpe_repetir");
                showOptions(['Entrega', 'Retirar no local']);
            }
            break;
        case 'bairro':
            state.address.bairro = message;
            addBotMessage("Agora, informe sua rua:", "Informe_rua");
            state.currentStep = 'rua';
            break;
        case 'rua':
            state.address.rua = message;
            addBotMessage("Por Ãºltimo, informe o nÃºmero:", "Informe_numero");
            state.currentStep = 'numero';
            break;
        case 'numero':
            state.address.numero = message;
            finalizePedido();
            break;
        case 'finished':
            if (message.toLowerCase() === 'novo pedido') {
                resetOrder();
            } else {
                addBotMessage("Desculpe, nÃ£o entendi. Pode repetir?", "Desculpe_repetir");
            }
            break;
        default:
            addBotMessage("Desculpe, nÃ£o entendi. Pode repetir?", "Desculpe_repetir");
    }
}

function showOptions(options) {
    optionsButtons.innerHTML = '';
    options.forEach(option => {
        const button = document.createElement('button');
        button.textContent = option;
        button.className = 'option-btn';
        button.onclick = () => {
            addMessage(option, 'user-message');
            processMessage(option);
        };
        optionsButtons.appendChild(button);
    });
}

function showPizzaOptions() {
    optionsButtons.innerHTML = '';
    pizzas.forEach(pizza => {
        const button = document.createElement('div');
        button.className = 'pizza-option';
        button.innerHTML = `
            <img src="${pizza.image}" alt="${pizza.name}">
            <button class="option-btn">${pizza.name}</button>
        `;
        button.querySelector('.option-btn').onclick = () => {
            addMessage(pizza.name, 'user-message');
            processMessage(pizza.name);
        };
        optionsButtons.appendChild(button);
    });
    
    const mixedButton = document.createElement('button');
    mixedButton.textContent = 'Pizza Mista (Dois Sabores)';
    mixedButton.className = 'option-btn';
    mixedButton.onclick = () => {
        addMessage('Pizza Mista', 'user-message');
        showMixedPizzaOptions();
    };
    optionsButtons.appendChild(mixedButton);
}

function showMixedPizzaOptions() {
    addBotMessage('Escolha o primeiro sabor:', "Escolha_segundo_sabor");
    showPizzaOptions();
    state.currentStep = 'mixed_pizza_1';
}

function showSizeOptions() {
    addBotMessage("Escolha o tamanho da pizza:", "Escolha_tamanho");
    showOptions(['M - R$ 34,99', 'G - R$ 39,99']);
    state.currentStep = 'size_selection';
}

function showBorderOptions() {
    addBotMessage("Deseja borda recheada? (+ R$ 3,00)", "Deseja_borda");
    showOptions(['Sim', 'NÃ£o']);
    state.currentStep = 'border_selection';
}

function addPizzaToCart() {
    let pizza = state.selectedPizzas.length === 1 ? state.selectedPizzas[0] : {
        name: `Mista (${state.selectedPizzas[0].name} / ${state.selectedPizzas[1].name})`,
        price: (state.selectedPizzas[0].price + state.selectedPizzas[1].price) / 2
    };
    addToCart(pizza);
}

function finalizePedido() {
    updateTotalPrice();
    const orderDetails = cart.map(item => `${item.name} (${item.size}${item.stuffedBorder ? ', Borda Recheada' : ''}) x${item.quantity} - R$ ${(item.price * item.quantity).toFixed(2)}`).join('\n');
    let message = `*Pedido confirmado!*\n${orderDetails}\n`;
    
    if (state.deliveryMethod === 'delivery') {
        message += `EndereÃ§o de entrega:\n*Rua:* ${state.address.rua}, \n*N:* ${state.address.numero},\n*Bairro:* ${state.address.bairro}\n`;
        message += `Taxa de entrega: R$ 3,00\n`;
    } else {
        message += `Retirada no local\n`;
    }
    
    message += `Total: R$ ${state.totalPrice.toFixed(2)} \n
    *Nome: ${state.userName}*`;
    
    addBotMessage("Pedido confirmado!", "Pedido_confirmado");
    addBotMessage(`Total: R$ ${state.totalPrice.toFixed(2)}`, "Total_preco");
    
    const whatsappMessage = encodeURIComponent(message);
    const whatsappLink = `https://wa.me/556799149659?text=${whatsappMessage}`;
    
    addBotMessage(`Clique aqui para enviar o pedido pelo WhatsApp: <a href="${whatsappLink}" target="_blank">Enviar Pedido</a>`, "Enviar_whatsapp");
    
    cart.length = 0;
    updateCart();
    updateTotalPrice();
    updateGif();
    state.currentStep = 'finished';
    showOptions(['Novo Pedido']);
}

function increaseQuantity(index) {
    cart[index].quantity++;
    updateCart();
    updateTotalPrice();
}

function decreaseQuantity(index) {
    if (cart[index].quantity > 1) {
        cart[index].quantity--;
    } else {
        cart.splice(index, 1);
    }
    updateCart();
    updateTotalPrice();
}

function resetOrder() {
    state = {
        userName: '',
        selectedPizzas: [],
        size: '',
        stuffedBorder: false,
        paymentMethod: '',
        deliveryMethod: '',
        address: {},
        totalPrice: 0,
        currentStep: 'name'
    };
    cart.length = 0;
    updateCart();
    updateTotalPrice();
    updateGif();
    chatBox.innerHTML = '';
}

</script>
</body>
</html>
